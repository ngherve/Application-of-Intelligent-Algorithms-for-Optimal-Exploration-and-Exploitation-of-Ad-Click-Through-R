package honours.smartads_agent.datareader;

/**
 * @author 217092052
 * Helper Class for reading file and calculating distance
 */
import java.io.*;
import java.util.ArrayList;

/**
 * @author 217092052
 * Helper Class for reading file
 */
public class File_Reader {
	
	public File_Reader() {
		//default constructor
	}

	/**
	 * Read File
	 * @param FileName
	 * @return ArrayList<string>
	 */
	public static ArrayList<String> readCSVFile(String path) {
		ArrayList<String> rows = new ArrayList<>();
		String rowData = "";
		String adsTitle = "";
		
		BufferedReader csvReader;
		try {
			csvReader = new BufferedReader(new FileReader(path));
			adsTitle = csvReader.readLine(); //getting the title ads
			while ((rowData = csvReader.readLine()) != null) {
			    if(!rowData.equals(adsTitle)) {
			    	rows.add(rowData);//reading the file input into string array
			    }
			}
			csvReader.close();
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return rows;
	}
	
	/**
	 * Read value of an index in the file
	 * @param FileName
	 * @param number of row
	 * @param number of column
	 * @return reward
	 */
	public static int readValue(ArrayList<String> fileData, int row, int col) {
		int reward = 0;
		String rowvalue = fileData.get(row);
		String[] data = rowvalue.split(",");

		for (int i = 0; i < 10; i++) {
			if(i==col) {
				reward = Integer.parseInt(data[i]);
			}
		}
		return reward;
	}
	
	/**
	 * 
	 * Calculating total clicks
	 * @param fileName
	 * @return total click records in the file
	 */
	public static int CalcTotNumClicks(String fileName) {
		
		ArrayList<String> fileLines = readCSVFile(fileName);
		
		int totalLines = fileLines.size();
		
		return totalLines;
	}
	
	/**
	 * 
	 * Calculate number of ads
	 * @param fileName
	 * @return numAds
	 */
	public static int NumAds(String fileName) {
		int totads = 0;
		
		ArrayList<String> fileLines = readCSVFile(fileName);
		String line = fileLines.get(0);
		String[] data = line.split(",");
		totads = data.length;
		
		return totads;
	}
}
